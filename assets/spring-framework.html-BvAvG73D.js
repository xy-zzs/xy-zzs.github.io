import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as c,o as l,c as i,a as p,b as n,d as t,w as e,e as u,f as s}from"./app-CoZ3ixxr.js";const k={},r=s('<h1 id="spring-framework-å¯¼èˆªæ " tabindex="-1"><a class="header-anchor" href="#spring-framework-å¯¼èˆªæ "><span>Spring Framework å¯¼èˆªæ </span></a></h1><h2 id="ioc" tabindex="-1"><a class="header-anchor" href="#ioc"><span>IOC</span></a></h2><p><strong>IoCï¼ˆInversion of Control æ§åˆ¶åè½¬ï¼‰</strong> æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„æŠ€æœ¯å®ç°ã€‚IoC çš„æ€æƒ³å°±æ˜¯å°†åŸæœ¬åœ¨ç¨‹åºä¸­æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒï¼Œäº¤ç”± Spring æ¡†æ¶æ¥ç®¡ç†ã€‚ä¸è¿‡ï¼Œ IoC å¹¶é Spring ç‰¹æœ‰ï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­ä¹Ÿæœ‰åº”ç”¨ã€‚</p><p>åœ¨ Spring ä¸­ï¼Œ IoC å®¹å™¨æ˜¯ Spring ç”¨æ¥å®ç° IoC çš„è½½ä½“ï¼Œ IoC å®¹å™¨å®é™…ä¸Šå°±æ˜¯ä¸ª Mapï¼ˆkeyï¼Œvalueï¼‰ï¼ŒMap ä¸­å­˜æ”¾çš„æ˜¯å„ç§å¯¹è±¡ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-spring-bean" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-spring-bean"><span>ä»€ä¹ˆæ˜¯ Spring Beanï¼Ÿ</span></a></h3>',5),d=s('<p>æˆ‘ä»¬éœ€è¦å‘Šè¯‰ IoC å®¹å™¨å¸®åŠ©æˆ‘ä»¬ç®¡ç†å“ªäº›å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¯é€šè¿‡é…ç½®å…ƒæ•°æ®æ¥å®šä¹‰çš„ã€‚é…ç½®å…ƒæ•°æ®å¯ä»¥æ˜¯ XML æ–‡ä»¶ã€æ³¨è§£æˆ–è€… Java é…ç½®ç±»ã€‚</p><h3 id="spring-bean-çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#spring-bean-çš„ç”Ÿå‘½å‘¨æœŸ"><span>Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ</span></a></h3><p>Spring Bean çš„ç”Ÿå‘½å‘¨æœŸåœ¨æ•´ä¸ª Spring ä¸­å æœ‰å¾ˆé‡è¦çš„ä½ç½®ï¼ŒæŒæ¡è¿™äº›å¯ä»¥åŠ æ·±å¯¹ Spring çš„ç†è§£ã€‚</p><p>Spring åªå¸®æˆ‘ä»¬ç®¡ç†å•ä¾‹æ¨¡å¼ Bean çš„<strong>å®Œæ•´</strong>ç”Ÿå‘½å‘¨æœŸï¼Œå¯¹äº prototype çš„ bean ï¼ŒSpring åœ¨åˆ›å»ºå¥½äº¤ç»™ä½¿ç”¨è€…ä¹‹ååˆ™ä¸ä¼šå†ç®¡ç†åç»­çš„ç”Ÿå‘½å‘¨æœŸã€‚</p><figure><img src="http://images.xyzzs.top/image/image-20230201160337683.png_char" alt="image-20230201160337683" tabindex="0" loading="lazy"><figcaption>image-20230201160337683</figcaption></figure><ul><li>Bean å®¹å™¨æ‰¾åˆ°é…ç½®æ–‡ä»¶ä¸­ Spring Bean çš„å®šä¹‰ã€‚</li><li>Bean å®¹å™¨åˆ©ç”¨ Java Reflection API åˆ›å»ºä¸€ä¸ª Bean çš„å®ä¾‹ã€‚</li><li>å¦‚æœæ¶‰åŠåˆ°ä¸€äº›å±æ€§å€¼ åˆ©ç”¨ <code>set()</code>æ–¹æ³•è®¾ç½®ä¸€äº›å±æ€§å€¼ã€‚</li><li>å¦‚æœ Bean å®ç°äº† <code>BeanNameAware</code> æ¥å£ï¼Œè°ƒç”¨ <code>setBeanName()</code>æ–¹æ³•ï¼Œä¼ å…¥ Bean çš„åå­—ã€‚</li><li>å¦‚æœ Bean å®ç°äº† <code>BeanClassLoaderAware</code> æ¥å£ï¼Œè°ƒç”¨ <code>setBeanClassLoader()</code>æ–¹æ³•ï¼Œä¼ å…¥ <code>ClassLoader</code>å¯¹è±¡çš„å®ä¾‹ã€‚</li><li>å¦‚æœ Bean å®ç°äº† <code>BeanFactoryAware</code> æ¥å£ï¼Œè°ƒç”¨ <code>setBeanFactory()</code>æ–¹æ³•ï¼Œä¼ å…¥ <code>BeanFactory</code>å¯¹è±¡çš„å®ä¾‹ã€‚</li><li>ä¸ä¸Šé¢çš„ç±»ä¼¼ï¼Œå¦‚æœå®ç°äº†å…¶ä»– <code>*.Aware</code>æ¥å£ï¼Œå°±è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚</li><li>å¦‚æœæœ‰å’ŒåŠ è½½è¿™ä¸ª Bean çš„ Spring å®¹å™¨ç›¸å…³çš„ <code>BeanPostProcessor</code> å¯¹è±¡ï¼Œæ‰§è¡Œ<code>postProcessBeforeInitialization()</code> æ–¹æ³•</li><li>å¦‚æœ Bean å®ç°äº†<code>InitializingBean</code>æ¥å£ï¼Œæ‰§è¡Œ<code>afterPropertiesSet()</code>æ–¹æ³•ã€‚</li><li>å¦‚æœ Bean åœ¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰åŒ…å« init-method å±æ€§ï¼Œæ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ã€‚</li><li>å¦‚æœæœ‰å’ŒåŠ è½½è¿™ä¸ª Bean çš„ Spring å®¹å™¨ç›¸å…³çš„ <code>BeanPostProcessor</code> å¯¹è±¡ï¼Œæ‰§è¡Œ<code>postProcessAfterInitialization()</code> æ–¹æ³•</li><li>å½“è¦é”€æ¯ Bean çš„æ—¶å€™ï¼Œå¦‚æœ Bean å®ç°äº† <code>DisposableBean</code> æ¥å£ï¼Œæ‰§è¡Œ <code>destroy()</code> æ–¹æ³•ã€‚</li><li>å½“è¦é”€æ¯ Bean çš„æ—¶å€™ï¼Œå¦‚æœ Bean åœ¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰åŒ…å« destroy-method å±æ€§ï¼Œæ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ã€‚</li></ul><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªç±»ä¼¼çš„ç®€åŒ–ç‰ˆ</p><figure><img src="http://images.xyzzs.top/image/image-20230201162748686.png_char" alt="image-20230201162748686" tabindex="0" loading="lazy"><figcaption>image-20230201162748686</figcaption></figure><h3 id="spring-ioc-çš„å®¹å™¨æ„å»ºæµç¨‹" tabindex="-1"><a class="header-anchor" href="#spring-ioc-çš„å®¹å™¨æ„å»ºæµç¨‹"><span>Spring IoC çš„å®¹å™¨æ„å»ºæµç¨‹</span></a></h3><figure><img src="http://images.xyzzs.top/image/image-20230201165919029.png_char" alt="image-20230201165919029" tabindex="0" loading="lazy"><figcaption>image-20230201165919029</figcaption></figure><h3 id="beanfactory-å’Œ-factorybean-çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#beanfactory-å’Œ-factorybean-çš„åŒºåˆ«"><span>BeanFactory å’Œ FactoryBean çš„åŒºåˆ«</span></a></h3><p>BeanFactoryï¼šSpring å®¹å™¨æœ€æ ¸å¿ƒä¹Ÿæ˜¯æœ€åŸºç¡€çš„æ¥å£ï¼Œæœ¬è´¨æ˜¯ä¸ªå·¥å‚ç±»ï¼Œç”¨äºç®¡ç† bean çš„å·¥å‚ï¼Œæœ€æ ¸å¿ƒçš„åŠŸèƒ½æ˜¯åŠ è½½ beanï¼Œä¹Ÿå°±æ˜¯ getBean æ–¹æ³•ï¼Œé€šå¸¸æˆ‘ä»¬ä¸ä¼šç›´æ¥ä½¿ç”¨è¯¥æ¥å£ï¼Œè€Œæ˜¯ä½¿ç”¨å…¶å­æ¥å£ã€‚</p>',12),v=s(`<p>FactoryBean è¢«å¹¿æ³›åº”ç”¨äº Java ç›¸å…³çš„ä¸­é—´ä»¶ä¸­ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œéƒ½æ˜¯é€šè¿‡ FactoryBean#getObject æ¥è¿”å›ä¸€ä¸ªä»£ç†ç±»ï¼Œå½“æˆ‘ä»¬è§¦å‘è°ƒç”¨æ—¶ï¼Œä¼šèµ°åˆ°ä»£ç†ç±»ä¸­ï¼Œä»è€Œå¯ä»¥åœ¨ä»£ç†ç±»ä¸­å®ç°ä¸­é—´ä»¶çš„è‡ªå®šä¹‰é€»è¾‘ï¼Œæ¯”å¦‚ï¼šRPC æœ€æ ¸å¿ƒçš„å‡ ä¸ªåŠŸèƒ½ï¼Œé€‰å€ã€å»ºç«‹è¿æ¥ã€è¿œç¨‹è°ƒç”¨ï¼Œè¿˜æœ‰ä¸€äº›è‡ªå®šä¹‰çš„ç›‘æ§ã€é™æµç­‰ç­‰ã€‚</p><h3 id="beanfactory-å’Œ-applicationcontext-çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#beanfactory-å’Œ-applicationcontext-çš„åŒºåˆ«"><span>BeanFactory å’Œ ApplicationContext çš„åŒºåˆ«</span></a></h3><p>BeanFactoryï¼šåŸºç¡€ IoC å®¹å™¨ï¼Œæä¾›å®Œæ•´çš„ IoC æœåŠ¡æ”¯æŒã€‚</p><p>ApplicationContextï¼šé«˜çº§ IoC å®¹å™¨ï¼ŒBeanFactory çš„å­æ¥å£ï¼Œåœ¨ BeanFactory çš„åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ã€‚åŒ…å« BeanFactory çš„æ‰€æœ‰åŠŸèƒ½ï¼Œè¿˜æä¾›äº†å…¶ä»–é«˜çº§çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ï¼šäº‹ä»¶å‘å¸ƒã€å›½é™…åŒ–ä¿¡æ¯æ”¯æŒã€ç»Ÿä¸€èµ„æºåŠ è½½ç­–ç•¥ç­‰ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨çš„ ApplicationContextã€‚</p><h3 id="å°†ä¸€ä¸ªç±»å£°æ˜ä¸º-bean-çš„æ³¨è§£æœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#å°†ä¸€ä¸ªç±»å£°æ˜ä¸º-bean-çš„æ³¨è§£æœ‰å“ªäº›"><span>å°†ä¸€ä¸ªç±»å£°æ˜ä¸º Bean çš„æ³¨è§£æœ‰å“ªäº›?</span></a></h3><ul><li><code>@Controller</code> : å¯¹åº” Spring MVC æ§åˆ¶å±‚ï¼Œä¸»è¦ç”¨æˆ·æ¥å—ç”¨æˆ·è¯·æ±‚å¹¶è°ƒç”¨ Service å±‚è¿”å›æ•°æ®ç»™å‰ç«¯é¡µé¢</li><li><code>@Service</code> : å¯¹åº”æœåŠ¡å±‚ï¼Œä¸»è¦æ¶‰åŠä¸€äº›å¤æ‚çš„é€»è¾‘ã€‚</li><li><code>@Component</code> ï¼šé€šç”¨çš„æ³¨è§£ï¼Œå¯æ ‡æ³¨ä»»æ„ç±»ä¸º <code>Spring</code> ç»„ä»¶ã€‚å¦‚æœä¸€ä¸ª Bean ä¸çŸ¥é“å±äºå“ªä¸ªå±‚ï¼Œå¯ä»¥ä½¿ç”¨<code>@Component</code> æ³¨è§£æ ‡æ³¨ã€‚</li><li><code>@Repository</code> : å¯¹åº”æŒä¹…å±‚å³ Dao å±‚ï¼Œä¸»è¦ç”¨äºæ•°æ®åº“ç›¸å…³æ“ä½œã€‚</li></ul><h3 id="resource-å’Œ-autowire-çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#resource-å’Œ-autowire-çš„åŒºåˆ«"><span>@Resource å’Œ @Autowire çš„åŒºåˆ«</span></a></h3><p>1ã€@Resource å’Œ @Autowired éƒ½å¯ä»¥ç”¨æ¥è£…é… bean</p><p>2ã€@Autowired é»˜è®¤å…ˆæŒ‰<code>byType</code>ç±»å‹è£…é…ï¼Œå½“ä¸€ä¸ªæ¥å£å­˜åœ¨å¤šä¸ªå®ç°ç±»çš„è¯ï¼Œ<code>byType</code>å°±ä¸çŸ¥é“è¯¥æ³¨å…¥å“ªä¸ªäº†è¿™æ—¶ä¼šç”¨<code>å˜é‡å</code>æˆ–è€…<code>@Qualifier</code>æŒ‰<code>byName</code>å»åŒ¹é…åç§°ï¼ˆé€šå¸¸å°±æ˜¯é¦–å­—æ¯å°å†™çš„ç±»åï¼‰ï¼›é»˜è®¤æƒ…å†µä¸‹å¿…é¡»è¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼Œå¦‚æœè¦å…è®¸nullå€¼ï¼Œå¯ä»¥è®¾ç½®å®ƒçš„requiredå±æ€§ä¸ºfalseã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">UserServiceImpl1</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span><span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">UserServiceImpl2</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span><span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token keyword">class</span> demo <span class="token punctuation">{</span>
    <span class="token comment">// æŠ¥é”™ï¼ŒbyName å’Œ byType éƒ½æ— æ³•åŒ¹é…åˆ° bean</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token comment">// æ­£ç¡®æ³¨å…¥ SmsServiceImpl1 å¯¹è±¡å¯¹åº”çš„ bean</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userServiceImpl1<span class="token punctuation">;</span>


    <span class="token comment">// èƒ½æ­£ç¡®æ³¨å…¥  SmsServiceImpl2 å¯¹è±¡å¯¹åº”çš„ bean</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;userServiceImpl2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€@Resource å±äº JDK æä¾›çš„æ³¨è§£ï¼Œå¦‚æœæŒ‡å®šäº† name æˆ– typeï¼Œåˆ™æŒ‰æŒ‡å®šçš„è¿›è¡Œè£…é…ï¼›å¦‚æœéƒ½ä¸æŒ‡å®šï¼Œåˆ™ä¼˜å…ˆæŒ‰åç§°è£…é…ï¼Œå½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„ bean æ—¶æ‰æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…ã€‚</p><h3 id="component-å’Œ-bean-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#component-å’Œ-bean-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ"><span>@Component å’Œ @Bean çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h3><ul><li><code>@Component</code> æ³¨è§£ä½œç”¨äºç±»ï¼Œè€Œ<code>@Bean</code>æ³¨è§£ä½œç”¨äºæ–¹æ³•ã€‚</li><li><code>@Component</code>æ˜¯é€šè¿‡ç±»è·¯å¾„æ‰«æçš„æ–¹å¼è‡ªåŠ¨è£…é…beanåˆ°IOCå®¹å™¨ä¸­çš„ï¼Œè€Œ<code>@Bean</code>æ˜¯å°†æ–¹æ³•è¿”å›å€¼ä½œä¸ºbeanè‡ªåŠ¨è£…é…åˆ°IOCå®¹å™¨ä¸­çš„</li><li><code>@Bean</code> æ³¨è§£æ¯” <code>@Component</code> æ³¨è§£çš„è‡ªå®šä¹‰æ€§æ›´å¼ºï¼Œè€Œä¸”å¾ˆå¤šåœ°æ–¹æˆ‘ä»¬åªèƒ½é€šè¿‡ <code>@Bean</code> æ³¨è§£æ¥æ³¨å†Œ beanã€‚æ¯”å¦‚å½“æˆ‘ä»¬å¼•ç”¨ç¬¬ä¸‰æ–¹åº“ä¸­çš„ç±»éœ€è¦è£…é…åˆ° <code>Spring</code>å®¹å™¨æ—¶ï¼Œåˆ™åªèƒ½é€šè¿‡ <code>@Bean</code>æ¥å®ç°ã€‚</li></ul><h3 id="spring-æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#spring-æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜"><span>Spring æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜</span></a></h3><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/25864774/1664287368896-ff7173de-982d-46d1-9011-2baa5ad5754f.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>å¾ªç¯ä¾èµ–</p><p>ä¸€çº§ç¼“å­˜ï¼ˆå•ä¾‹æ± ï¼‰å¯è§£å†³æ­»å¾ªç¯é—®é¢˜</p><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/25864774/1664524603867-a23ebe22-c2de-4592-ba02-49e5b216bc7b.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>ç¬¬ä¸€çº§ç¼“å­˜ï¼šå­˜æ”¾å·²ç»ç»å†äº†å®Œæ•´ç”Ÿå‘½å‘¨æœŸçš„Beanå‘¨æœŸ</p><p>ç¬¬äºŒçº§ç¼“å­˜ï¼šå­˜æ”¾æ­£åœ¨å®ä¾‹åŒ–ä½†å±æ€§è¿˜æœªå¡«å……çš„Bean</p><p>ç¬¬ä¸‰çº§ç¼“å­˜ï¼šå­˜æ”¾ç”ŸæˆBean çš„å·¥å‚</p><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/25864774/1664335677021-a80c728b-0ce6-4055-88be-ba98f2db3800.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="aop" tabindex="-1"><a class="header-anchor" href="#aop"><span>AOP</span></a></h2><div class="language-latex line-numbers-mode" data-ext="latex" data-title="latex"><pre class="language-latex"><code>ajcå¢å¼º:buildæ’ä»¶ï¼Œä¿®æ”¹classå­—èŠ‚ç æ–‡ä»¶å¢å¼º
agentå¢å¼º: VM optine:-javaagent:..... è¿è¡Œæ—¶å¢å¼º
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jdk-åŠ¨æ€ä»£ç†" tabindex="-1"><a class="header-anchor" href="#jdk-åŠ¨æ€ä»£ç†"><span>JDK åŠ¨æ€ä»£ç†</span></a></h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œé™æ€ä»£ç†åªèƒ½ä»£ç†ä¸€ä¸ªå…·ä½“çš„ç±»ï¼Œå¦‚æœè¦ä»£ç†ä¸€ä¸ªæ¥å£çš„å¤šä¸ªå®ç°çš„è¯éœ€è¦å®šä¹‰ä¸åŒçš„ä»£ç†ç±»ã€‚éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜å°±å¯ä»¥ç”¨åˆ° JDK çš„åŠ¨æ€ä»£ç†ã€‚</p><p>å…¶ä¸­æœ‰ä¸¤ä¸ªéå¸¸æ ¸å¿ƒçš„ç±»:</p><ul><li><code>java.lang.reflect.Proxy</code>ç±»ã€‚</li><li><code>java.lang.reflect.InvocationHandler</code>æ¥å£ã€‚</li></ul><p><code>Proxy</code> ç±»æ˜¯ç”¨äºåˆ›å»ºä»£ç†å¯¹è±¡ï¼Œè€Œ <code>InvocationHandler</code> æ¥å£ä¸»è¦ä½ æ˜¯æ¥å¤„ç†æ‰§è¡Œé€»è¾‘ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxyFactory</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> target<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">ProxyFactory</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getProxyInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//arg1ï¼Œç±»åŠ è½½å™¨</span>
        <span class="token comment">//arg2ï¼šå¢å¼ºæ–¹æ³•æ‰€åœ¨çš„ç±»ï¼Œè¿™ä¸ªç±»å®ç°çš„æ¥å£ï¼Œæ”¯æŒå¤šä¸ªæ¥å£</span>
        <span class="token comment">//arg3ï¼šå®ç°è¿™ä¸ªæ¥å£ InvocationHandlerï¼Œåˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå†™å¢å¼ºçš„éƒ¨åˆ†</span>
        <span class="token keyword">return</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> method<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;JDKä»£ç†å¼€å§‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">Object</span> invoke <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;JDKä»£ç†ç»“æŸ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> invoke<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â—å•Šè¿™ã€‚ã€‚ã€‚ä¹Ÿå¤ªå¼ºäº†å§</p><p>ğŸ¤”è®©æˆ‘å¯¹åº•å±‚å¦‚ä½•å®ç°äº§ç”Ÿäº†æµ“åšçš„å…´è¶£ï¼Œé©¬ä¸Šäº†è§£ä¸€ä¸‹</p><p>JDKåŠ¨æ€ä»£ç†ï¼Œç”Ÿæˆä»£ç†ç±»æ—¶ï¼Œå¹¶æ²¡æœ‰ç»è¿‡æºç é˜¶æ®µå’Œç¼–è¯‘é˜¶æ®µ<code>.java</code>ï¼Œè€Œæ˜¯ç›´æ¥ç”Ÿæˆå­—èŠ‚ç æ–‡ä»¶<code>.calss</code>ï¼Œç»è¿‡å¯¹è¿è¡Œæ—¶å¯¹è±¡çš„åç¼–è¯‘ï¼Œæ‰‹å†™æ¨¡æ‹Ÿäº†æ ¸å¿ƒä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MyInvocationHandler</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span><span class="token class-name">Method</span> method<span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvocationTargetException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> $<span class="token class-name">Proxy0</span> <span class="token keyword">implements</span> <span class="token class-name">Foo</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">MyInvocationHandler</span> myInvocationHandler<span class="token punctuation">;</span>

    <span class="token keyword">public</span> $<span class="token class-name">Proxy0</span><span class="token punctuation">(</span><span class="token class-name">MyInvocationHandler</span> myInvocationHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myInvocationHandler <span class="token operator">=</span> myInvocationHandler<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span>  <span class="token class-name">Method</span> foo<span class="token punctuation">;</span>
    <span class="token keyword">static</span>  <span class="token class-name">Method</span> bar<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            foo <span class="token operator">=</span> <span class="token class-name">Foo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bar <span class="token operator">=</span> <span class="token class-name">Foo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchMethodException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchMethodError</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="token comment">//            Method foo = Foo.class.getDeclaredMethod(&quot;foo&quot;);</span>
            <span class="token class-name">Object</span> invoke <span class="token operator">=</span> myInvocationHandler<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>foo<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>invoke<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>throwable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="token comment">//            Method bar = Foo.class.getDeclaredMethod(&quot;bar&quot;);</span>
            myInvocationHandler<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>bar<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>throwable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvocationTargetException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvocationTargetException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token keyword">implements</span> <span class="token class-name">Foo</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span>  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ä»£ç å¦‚ä¸‹</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HandSpringJDK</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
        $<span class="token class-name">Proxy0</span> $<span class="token class-name">Proxy0</span> <span class="token operator">=</span> <span class="token keyword">new</span> $<span class="token class-name">Proxy0</span><span class="token punctuation">(</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> method<span class="token punctuation">,</span> args1<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;before...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> invoke <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> args1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> invoke<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $<span class="token class-name">Proxy0</span><span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $<span class="token class-name">Proxy0</span><span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥å‘ç°ï¼Œä»£ç å¯ä»¥è¯´æ˜¯å¹³å¹³æ— å¥‡ï¼Œæ²¡æœ‰ä»€ä¹ˆéš¾ç†è§£çš„ã€‚é‡è¦çš„æ˜¯è°å†™äº†è¿™äº›ä»£ç ï¼Œç­”æ¡ˆæ˜¯ä½¿ç”¨äº†<code>ASM</code>æŠ€æœ¯ï¼Œè¿™ä¸ªæŠ€æœ¯ä½œç”¨å°±æ˜¯åœ¨è¿è¡ŒæœŸé—´åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç æ–‡ä»¶ã€‚</p><h3 id="cglibåŠ¨æ€ä»£ç†" tabindex="-1"><a class="header-anchor" href="#cglibåŠ¨æ€ä»£ç†"><span>CglibåŠ¨æ€ä»£ç†</span></a></h3><p>ä¸€ç§æ— éœ€ç›®æ ‡ç±»å®ç°æ¥å£çš„å®ç°æ–¹å¼ï¼Œä½†ä¸èƒ½æ˜¯<code>final</code>ç±»ï¼Œå› ä¸ºéœ€è¦ç»§æ‰¿å®ƒæ¥å®ç°ã€‚ä»£ç ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CglibProxyDemo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">Target</span> target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Target</span> proxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">)</span> <span class="token class-name">Enhancer</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">MethodInterceptor</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>o<span class="token punctuation">,</span> method<span class="token punctuation">,</span> objects<span class="token punctuation">,</span> methodProxy<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;before...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//            Object invoke = method.invoke(target, objects);         //åå°„è°ƒç”¨</span>
<span class="token comment">//            Object invoke2 = methodProxy.invoke(target, objects);   //ä¸æ˜¯é‡‡ç”¨åå°„è°ƒç”¨ï¼Œéœ€è¦ç›®æ ‡,springé‡‡ç”¨</span>
            <span class="token class-name">Object</span> invoke3 <span class="token operator">=</span> methodProxy<span class="token punctuation">.</span><span class="token function">invokeSuper</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> objects<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//ä¸æ˜¯é‡‡ç”¨åå°„è°ƒç”¨ã€‚éœ€è¦ä»£ç†</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;bafter...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> invoke3<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxy<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;target&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿˜æ˜¯è€é—®é¢˜ï¼Œåº•å±‚å¦‚ä½•å®ç°ï¼Œè¯·çœ‹æ¨¡æ‹Ÿæºç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;save(int)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">long</span> l<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;save(long)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Proxy</span> <span class="token keyword">extends</span> <span class="token class-name">Target</span><span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MethodInterceptor</span> methodInterceptor<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMethodInterceptor</span><span class="token punctuation">(</span><span class="token class-name">MethodInterceptor</span> methodInterceptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>methodInterceptor <span class="token operator">=</span> methodInterceptor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">Method</span> save0<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">Method</span> save1<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">Method</span> save2<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">MethodProxy</span> save0Proxy<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">MethodProxy</span> save1Proxy<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">MethodProxy</span> save2Proxy<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            save0 <span class="token operator">=</span> <span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            save1 <span class="token operator">=</span> <span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            save2 <span class="token operator">=</span> <span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span> <span class="token keyword">long</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            save0Proxy <span class="token operator">=</span> <span class="token class-name">MethodProxy</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token string">&quot;()V&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;saveSuper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            save1Proxy <span class="token operator">=</span> <span class="token class-name">MethodProxy</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token string">&quot;(I)V&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;saveSuper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            save2Proxy <span class="token operator">=</span> <span class="token class-name">MethodProxy</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token string">&quot;(J)V&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;saveSuper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchMethodException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchMethodError</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//=============å¸¦åŸå§‹åŠŸèƒ½çš„æ–¹æ³•===========</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSuper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSuper</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSuper</span><span class="token punctuation">(</span><span class="token keyword">long</span> l<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment">//=============å¸¦å¢å¼ºåŠŸèƒ½çš„æ–¹æ³•===========</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            methodInterceptor<span class="token punctuation">.</span><span class="token function">intercept</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>save0<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>save0Proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>throwable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            methodInterceptor<span class="token punctuation">.</span><span class="token function">intercept</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>save1<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token punctuation">,</span>save1Proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            throwable<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>throwable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">long</span> l<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            methodInterceptor<span class="token punctuation">.</span><span class="token function">intercept</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>save2<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>l<span class="token punctuation">}</span><span class="token punctuation">,</span>save2Proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>throwable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿˜æœ‰å°±æ˜¯å¦‚ä½•å®ç°ä¸åå°„è°ƒç”¨ï¼Œé‚£å°±è°ƒç”¨<code>intercept()</code>æ—¶è¿”å›ä¸ªç›®æ ‡æ–¹æ³•å‘—ï¼Œä¸¤ä¸ªç±»çš„æ ¸å¿ƒæºç å¦‚ä¸‹</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxyFastClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token class-name">Signature</span> s0 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Signature</span><span class="token punctuation">(</span><span class="token string">&quot;saveSuper&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;()V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">Signature</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Signature</span><span class="token punctuation">(</span><span class="token string">&quot;saveSuper&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;(I)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">Signature</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Signature</span><span class="token punctuation">(</span><span class="token string">&quot;saveSuper&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;(J)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ç”¨ä¸‹æ ‡è®°å½•ç›®æ ‡æ–¹æ³•ï¼Œé¿å…äº†åå°„
     * <span class="token keyword">@param</span> <span class="token parameter">signature</span>
     * <span class="token keyword">@return</span>
     */</span>

    <span class="token comment">//è·å–ç›®æ ‡æ–¹æ³•ç¼–å·</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token class-name">Signature</span> signature<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s0<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>signature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>signature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>signature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//æ ¹æ®æ–¹æ³•ç¼–å·ï¼Œæ­£å¸¸è°ƒç”¨ç›®æ ‡å¯¹è±¡æ–¹æ³•</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Proxy</span><span class="token punctuation">)</span>proxy<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">saveSuper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Proxy</span><span class="token punctuation">)</span>proxy<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">saveSuper</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Proxy</span><span class="token punctuation">)</span>proxy<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">saveSuper</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;æ— æ­¤æ–¹æ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ProxyFastClass</span> proxyFastClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProxyFastClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> save <span class="token operator">=</span> proxyFastClass<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Signature</span><span class="token punctuation">(</span><span class="token string">&quot;saveSuper&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(I)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">;</span>
        proxyFastClass<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>save<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TargetFastClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token class-name">Signature</span> s0 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Signature</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;()V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">Signature</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Signature</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;(I)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">Signature</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Signature</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;(J)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ç”¨ä¸‹æ ‡è®°å½•ç›®æ ‡æ–¹æ³•ï¼Œé¿å…äº†åå°„
     * <span class="token keyword">@param</span> <span class="token parameter">signature</span>
     * <span class="token keyword">@return</span>
     */</span>

    <span class="token comment">//è·å–ç›®æ ‡æ–¹æ³•ç¼–å·</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token class-name">Signature</span> signature<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s0<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>signature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>signature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>signature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//æ ¹æ®æ–¹æ³•ç¼–å·ï¼Œæ­£å¸¸è°ƒç”¨ç›®æ ‡å¯¹è±¡æ–¹æ³•</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">)</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">)</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">)</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;æ— æ­¤æ–¹æ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TargetFastClass</span> targetFastClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TargetFastClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> save <span class="token operator">=</span> targetFastClass<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Signature</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(I)V&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">;</span>
        targetFastClass<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>save<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-ä»£ç†çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-ä»£ç†çš„åŒºåˆ«"><span>JDK åŠ¨æ€ä»£ç†å’Œ Cglib ä»£ç†çš„åŒºåˆ«</span></a></h3><p>1ã€JDK åŠ¨æ€ä»£ç†æœ¬è´¨ä¸Šæ˜¯å®ç°äº†è¢«ä»£ç†å¯¹è±¡çš„æ¥å£ï¼Œè€Œ Cglib æœ¬è´¨ä¸Šæ˜¯ç»§æ‰¿äº†è¢«ä»£ç†å¯¹è±¡ï¼Œè¦†ç›–å…¶ä¸­çš„æ–¹æ³•ã€‚</p><p>2ã€JDK åŠ¨æ€ä»£ç†åªèƒ½å¯¹å®ç°äº†æ¥å£çš„ç±»ç”Ÿæˆä»£ç†ï¼ŒCglib åˆ™æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚ä½†æ˜¯ Cglib å› ä¸ºä½¿ç”¨ç»§æ‰¿å®ç°ï¼Œæ‰€ä»¥ Cglib æ— æ³•ä»£ç†è¢« final ä¿®é¥°çš„æ–¹æ³•æˆ–ç±»ã€‚</p><p>3ã€åœ¨è°ƒç”¨ä»£ç†æ–¹æ³•ä¸Šï¼ŒJDK æ˜¯é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨ï¼ŒCglibæ˜¯é€šè¿‡FastClass æœºåˆ¶ç›´æ¥è°ƒç”¨ã€‚FastClass ç®€å•çš„ç†è§£ï¼Œå°±æ˜¯ä½¿ç”¨ index ä½œä¸ºå…¥å‚ï¼Œå¯ä»¥ç›´æ¥å®šä½åˆ°è¦è°ƒç”¨çš„æ–¹æ³•ç›´æ¥è¿›è¡Œè°ƒç”¨ã€‚</p><p>4ã€åœ¨æ€§èƒ½ä¸Šï¼ŒJDK1.7 ä¹‹å‰ï¼Œç”±äºä½¿ç”¨äº† FastClass æœºåˆ¶ï¼ŒCglib åœ¨æ‰§è¡Œæ•ˆç‡ä¸Šæ¯” JDK å¿«ï¼Œä½†æ˜¯éšç€ JDK åŠ¨æ€ä»£ç†çš„ä¸æ–­ä¼˜åŒ–ï¼Œä» JDK 1.7 å¼€å§‹ï¼ŒJDK åŠ¨æ€ä»£ç†å·²ç»æ˜æ˜¾æ¯” Cglib æ›´å¿«äº†ã€‚</p><h3 id="spring-çš„-aop-æœ‰å“ªå‡ ç§åˆ›å»ºä»£ç†çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#spring-çš„-aop-æœ‰å“ªå‡ ç§åˆ›å»ºä»£ç†çš„æ–¹å¼"><span>Spring çš„ AOP æœ‰å“ªå‡ ç§åˆ›å»ºä»£ç†çš„æ–¹å¼</span></a></h3><p>Spring ä¸­çš„ AOP ç›®å‰æ”¯æŒ JDK åŠ¨æ€ä»£ç†å’Œ Cglib ä»£ç†ã€‚</p><p>é€šå¸¸æ¥è¯´ï¼šå¦‚æœè¢«ä»£ç†å¯¹è±¡å®ç°äº†æ¥å£ï¼Œåˆ™ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå¦åˆ™ä½¿ç”¨ Cglib ä»£ç†ã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®š proxyTargetClass=true æ¥å®ç°å¼ºåˆ¶èµ° Cglib ä»£ç†ã€‚</p><h2 id="springäº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#springäº‹åŠ¡"><span>Springäº‹åŠ¡</span></a></h2><h3 id="springäº‹åŠ¡ä¼ æ’­æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#springäº‹åŠ¡ä¼ æ’­æœºåˆ¶"><span>Springäº‹åŠ¡ä¼ æ’­æœºåˆ¶</span></a></h3><p>PROPAGATION_REQUIREDâ€”â€”requiredéœ€è¦ï¼Œæ²¡æœ‰æ–°å»ºï¼Œæœ‰åŠ å…¥ï¼ˆé»˜è®¤ï¼‰</p><p>å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œè¿™æ˜¯æœ€å¸¸è§çš„é€‰æ‹©ï¼Œä¹Ÿæ˜¯Springé»˜è®¤çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€‚</p><p>å½“Aè°ƒç”¨Bçš„æ—¶å€™ï¼šå¦‚æœAä¸­æ²¡æœ‰äº‹åŠ¡ï¼ŒBä¸­æœ‰äº‹åŠ¡ï¼Œé‚£ä¹ˆBä¼šæ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼›å¦‚æœAä¸­ä¹Ÿæœ‰äº‹åŠ¡ã€Bä¸­ä¹Ÿæœ‰äº‹åŠ¡ï¼Œé‚£ä¹ˆBä¼šåŠ å…¥åˆ°Aä¸­å»ï¼Œå˜æˆä¸€ä¸ªäº‹åŠ¡ï¼Œè¿™æ—¶ï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚ï¼ˆå‡å¦‚Aä¸­æœ‰2ä¸ªSQLï¼ŒBä¸­æœ‰ä¸¤ä¸ªSQLï¼Œé‚£ä¹ˆè¿™å››ä¸ªSQLä¼šå˜æˆä¸€ä¸ªSQLï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ï¼‰</p><p>PROPAGATION_REQUIRES_NEWâ€”â€”requires_newéœ€è¦æ–°çš„ï¼Œä¸ç®¡æœ‰æ²¡æœ‰ï¼Œç›´æ¥åˆ›å»ºæ–°äº‹åŠ¡</p><p>åˆ›å»ºæ–°äº‹åŠ¡ï¼Œæ— è®ºå½“å‰å­˜ä¸å­˜åœ¨äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡ã€‚</p><p>Bä¼šæ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼ŒAå’ŒBäº‹åŠ¡äº’ä¸å¹²æ‰°ï¼Œä»–ä»¬å‡ºç°é—®é¢˜å›æ»šçš„æ—¶å€™ï¼Œä¹Ÿéƒ½åªå›æ»šè‡ªå·±çš„äº‹åŠ¡ï¼›</p><p>PROPAGATION_SUPPORTSâ€”â€”supportsæ”¯æŒï¼Œæœ‰åˆ™åŠ å…¥ï¼Œæ²¡æœ‰å°±ä¸ç®¡äº†ï¼Œéäº‹åŠ¡è¿è¡Œ</p><p>æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ‰§è¡Œã€‚</p><p>å¦‚æœAä¸­æœ‰äº‹åŠ¡ï¼Œåˆ™Bæ–¹æ³•çš„äº‹åŠ¡åŠ å…¥Aäº‹åŠ¡ä¸­ï¼Œæˆä¸ºä¸€ä¸ªäº‹åŠ¡ï¼ˆä¸€èµ·æˆåŠŸï¼Œä¸€èµ·å¤±è´¥ï¼‰ï¼Œå¦‚æœAä¸­æ²¡æœ‰äº‹åŠ¡ï¼Œé‚£ä¹ˆBå°±ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼ˆæ‰§è¡Œå®Œç›´æ¥æäº¤ï¼‰ï¼›</p><p>PROPAGATION_NOT_SUPPORTEDâ€”â€”not supportedä¸æ”¯æŒäº‹åŠ¡ï¼Œå­˜åœ¨å°±æŒ‚èµ·</p><p>ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚</p><p>è¢«è°ƒç”¨è€…Bä¼šä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼ˆç›´æ¥æäº¤ï¼‰ï¼Œå¦‚æœå½“å‰æœ‰äº‹åŠ¡ï¼Œä¹Ÿå°±æ˜¯Aä¸­æœ‰äº‹åŠ¡ï¼ŒAä¼šè¢«æŒ‚èµ·ï¼ˆä¸æ‰§è¡Œï¼Œç­‰å¾…Bæ‰§è¡Œå®Œï¼Œè¿”å›ï¼‰ï¼›Aå’ŒBå‡ºç°å¼‚å¸¸éœ€è¦å›æ»šï¼Œäº’ä¸å½±å“</p><p>PROPAGATION_MANDATORYâ€”â€”mandatoryå¼ºåˆ¶æ€§ï¼Œæœ‰åˆ™åŠ å…¥ï¼Œæ²¡æœ‰å¼‚å¸¸</p><p>æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œå¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>å¦‚æœAä¸­æœ‰äº‹åŠ¡ï¼Œåˆ™Bæ–¹æ³•çš„äº‹åŠ¡åŠ å…¥Aäº‹åŠ¡ä¸­ï¼Œæˆä¸ºä¸€ä¸ªäº‹åŠ¡ï¼ˆä¸€èµ·æˆåŠŸï¼Œä¸€èµ·å¤±è´¥ï¼‰ï¼›å¦‚æœAä¸­æ²¡æœ‰äº‹åŠ¡ï¼ŒBä¸­æœ‰äº‹åŠ¡ï¼Œé‚£ä¹ˆBå°±ç›´æ¥æŠ›å¼‚å¸¸äº†ï¼Œæ„æ€æ˜¯Bå¿…é¡»è¦æ”¯æŒå›æ»šçš„äº‹åŠ¡ä¸­è¿è¡Œ</p><p>PROPAGATION_NEVERâ€”â€”neverä¸æ”¯æŒäº‹åŠ¡ï¼Œå­˜åœ¨å°±å¼‚å¸¸</p><p>ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>Aä¸­ä¸èƒ½æœ‰äº‹åŠ¡ï¼Œå¦‚æœæ²¡æœ‰ï¼ŒBå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœAå­˜åœ¨äº‹åŠ¡ï¼Œé‚£ä¹ˆç›´æ¥æŠ›å¼‚å¸¸</p><p>PROPAGATION_NESTEDâ€”â€”nestedå­˜åœ¨å°±åœ¨åµŒå¥—çš„æ‰§è¡Œï¼Œæ²¡æœ‰å°±æ‰¾æ˜¯å¦å­˜åœ¨å¤–é¢çš„äº‹åŠ¡ï¼Œæœ‰åˆ™åŠ å…¥ï¼Œæ²¡æœ‰åˆ™æ–°å»º</p><p>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‰REQUIREDå±æ€§æ‰§è¡Œã€‚</p><p>å¦‚æœAä¸­æ²¡æœ‰äº‹åŠ¡ï¼Œé‚£ä¹ˆBåˆ›å»ºä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œï¼Œå¦‚æœAä¸­ä¹Ÿæœ‰äº‹åŠ¡ï¼Œé‚£ä¹ˆBä¼šä¼šæŠŠäº‹åŠ¡åµŒå¥—åœ¨é‡Œé¢ã€‚</p><p><strong>å¯¹äº‹åŠ¡è¦æ±‚ç¨‹åº¦å¯ä»¥ä»å¤§åˆ°å°æ’åºï¼šmandatory / supports / required / requires_new / nested / not supported / never</strong></p><h3 id="spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯å¦‚ä½•åšåˆ°å’Œæ•°æ®åº“ä¸ä¸€è‡´çš„-5åˆ†" tabindex="-1"><a class="header-anchor" href="#spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯å¦‚ä½•åšåˆ°å’Œæ•°æ®åº“ä¸ä¸€è‡´çš„-5åˆ†"><span>Spring çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯å¦‚ä½•åšåˆ°å’Œæ•°æ®åº“ä¸ä¸€è‡´çš„ï¼Ÿï¼ˆ5åˆ†ï¼‰</span></a></h3><p>æ¯”å¦‚æ•°æ®åº“æ˜¯å¯é‡å¤è¯»ï¼ŒSpring æ˜¯è¯»å·²æäº¤ï¼Œè¿™æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p><p>Spring çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æœ¬è´¨ä¸Šè¿˜æ˜¯é€šè¿‡æ•°æ®åº“æ¥æ§åˆ¶çš„ï¼Œå…·ä½“æ˜¯åœ¨æ‰§è¡Œäº‹åŠ¡å‰å…ˆæ‰§è¡Œå‘½ä»¤ä¿®æ”¹æ•°æ®åº“éš”ç¦»çº§åˆ«ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š</p><div class="language-mysql line-numbers-mode" data-ext="mysql" data-title="mysql"><pre class="language-mysql"><code>SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="springäº‹ç‰©ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ" tabindex="-1"><a class="header-anchor" href="#springäº‹ç‰©ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ"><span>springäº‹ç‰©ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ</span></a></h3><p>springäº‹ç‰©åŸç†æ˜¯AOP</p><p>1.å‘ç”Ÿè‡ªè°ƒç”¨</p><p>2.æ–¹æ³•ä¸æ˜¯public</p><p>3.æ•°æ®åº“ä¸æ”¯æŒäº‹ç‰©</p><p>4.æ²¡æœ‰è¢«Springç®¡ç†</p><p>5.å¼‚å¸¸è¢«åƒæ‰ï¼Œäº‹ç‰©ä¸ä¼šå›æ»š</p>`,88);function m(b,g){const a=c("font");return l(),i("div",null,[r,p("p",null,[n("ç®€å•æ¥è¯´ï¼ŒBean ä»£æŒ‡çš„å°±æ˜¯é‚£äº›"),t(a,{color:"orchid"},{default:e(()=>[n("è¢« IoC å®¹å™¨æ‰€ç®¡ç†çš„å¯¹è±¡")]),_:1}),n("ã€‚")]),d,p("p",null,[n("FactoryBeanï¼šè¯¥æ¥å£ä»¥ bean æ ·å¼å®šä¹‰ï¼Œä½†æ˜¯å®ƒä¸æ˜¯ä¸€ç§æ™®é€šçš„ beanï¼Œå®ƒæ˜¯ä¸ªå·¥å‚ beanï¼Œå®ç°è¯¥æ¥å£çš„ç±»å¯ä»¥"),t(a,{color:"orchid"},{default:e(()=>[n("è‡ªå·±å®šä¹‰è¦åˆ›å»ºçš„ bean å®ä¾‹")]),_:1}),n("ï¼Œåªéœ€è¦å®ç°å®ƒçš„ getObject æ–¹æ³•å³å¯ã€‚")]),v,u(" https://blog.csdn.net/v123411739/article/details/110009966 ")])}const h=o(k,[["render",m],["__file","spring-framework.html.vue"]]),f=JSON.parse('{"path":"/spring/spring-framework.html","title":"Spring Framework å¯¼èˆªæ ","lang":"zh-CN","frontmatter":{"description":"Spring Framework å¯¼èˆªæ  IOC IoCï¼ˆInversion of Control æ§åˆ¶åè½¬ï¼‰ æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„æŠ€æœ¯å®ç°ã€‚IoC çš„æ€æƒ³å°±æ˜¯å°†åŸæœ¬åœ¨ç¨‹åºä¸­æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒï¼Œäº¤ç”± Spring æ¡†æ¶æ¥ç®¡ç†ã€‚ä¸è¿‡ï¼Œ IoC å¹¶é Spring ç‰¹æœ‰ï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­ä¹Ÿæœ‰åº”ç”¨ã€‚ åœ¨ Spring ä¸­ï¼Œ IoC å®¹å™¨æ˜¯ Spri...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/spring/spring-framework.html"}],["meta",{"property":"og:site_name","content":"æ–‡æ¡£æ¼”ç¤º"}],["meta",{"property":"og:title","content":"Spring Framework å¯¼èˆªæ "}],["meta",{"property":"og:description","content":"Spring Framework å¯¼èˆªæ  IOC IoCï¼ˆInversion of Control æ§åˆ¶åè½¬ï¼‰ æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„æŠ€æœ¯å®ç°ã€‚IoC çš„æ€æƒ³å°±æ˜¯å°†åŸæœ¬åœ¨ç¨‹åºä¸­æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒï¼Œäº¤ç”± Spring æ¡†æ¶æ¥ç®¡ç†ã€‚ä¸è¿‡ï¼Œ IoC å¹¶é Spring ç‰¹æœ‰ï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­ä¹Ÿæœ‰åº”ç”¨ã€‚ åœ¨ Spring ä¸­ï¼Œ IoC å®¹å™¨æ˜¯ Spri..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://images.xyzzs.top/image/image-20230201160337683.png_char"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-24T15:46:57.000Z"}],["meta",{"property":"article:author","content":"Mr.Hope"}],["meta",{"property":"article:modified_time","content":"2024-04-24T15:46:57.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Spring Framework å¯¼èˆªæ \\",\\"image\\":[\\"http://images.xyzzs.top/image/image-20230201160337683.png_char\\",\\"http://images.xyzzs.top/image/image-20230201162748686.png_char\\",\\"http://images.xyzzs.top/image/image-20230201165919029.png_char\\",\\"https://cdn.nlark.com/yuque/0/2022/png/25864774/1664287368896-ff7173de-982d-46d1-9011-2baa5ad5754f.png\\",\\"https://cdn.nlark.com/yuque/0/2022/png/25864774/1664524603867-a23ebe22-c2de-4592-ba02-49e5b216bc7b.png\\",\\"https://cdn.nlark.com/yuque/0/2022/png/25864774/1664335677021-a80c728b-0ce6-4055-88be-ba98f2db3800.png\\"],\\"dateModified\\":\\"2024-04-24T15:46:57.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Hope\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"IOC","slug":"ioc","link":"#ioc","children":[{"level":3,"title":"ä»€ä¹ˆæ˜¯ Spring Beanï¼Ÿ","slug":"ä»€ä¹ˆæ˜¯-spring-bean","link":"#ä»€ä¹ˆæ˜¯-spring-bean","children":[]},{"level":3,"title":"Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ","slug":"spring-bean-çš„ç”Ÿå‘½å‘¨æœŸ","link":"#spring-bean-çš„ç”Ÿå‘½å‘¨æœŸ","children":[]},{"level":3,"title":"Spring IoC çš„å®¹å™¨æ„å»ºæµç¨‹","slug":"spring-ioc-çš„å®¹å™¨æ„å»ºæµç¨‹","link":"#spring-ioc-çš„å®¹å™¨æ„å»ºæµç¨‹","children":[]},{"level":3,"title":"BeanFactory å’Œ FactoryBean çš„åŒºåˆ«","slug":"beanfactory-å’Œ-factorybean-çš„åŒºåˆ«","link":"#beanfactory-å’Œ-factorybean-çš„åŒºåˆ«","children":[]},{"level":3,"title":"BeanFactory å’Œ ApplicationContext çš„åŒºåˆ«","slug":"beanfactory-å’Œ-applicationcontext-çš„åŒºåˆ«","link":"#beanfactory-å’Œ-applicationcontext-çš„åŒºåˆ«","children":[]},{"level":3,"title":"å°†ä¸€ä¸ªç±»å£°æ˜ä¸º Bean çš„æ³¨è§£æœ‰å“ªäº›?","slug":"å°†ä¸€ä¸ªç±»å£°æ˜ä¸º-bean-çš„æ³¨è§£æœ‰å“ªäº›","link":"#å°†ä¸€ä¸ªç±»å£°æ˜ä¸º-bean-çš„æ³¨è§£æœ‰å“ªäº›","children":[]},{"level":3,"title":"@Resource å’Œ @Autowire çš„åŒºåˆ«","slug":"resource-å’Œ-autowire-çš„åŒºåˆ«","link":"#resource-å’Œ-autowire-çš„åŒºåˆ«","children":[]},{"level":3,"title":"@Component å’Œ @Bean çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ","slug":"component-å’Œ-bean-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ","link":"#component-å’Œ-bean-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ","children":[]},{"level":3,"title":"Spring æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜","slug":"spring-æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜","link":"#spring-æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜","children":[]}]},{"level":2,"title":"AOP","slug":"aop","link":"#aop","children":[{"level":3,"title":"JDK åŠ¨æ€ä»£ç†","slug":"jdk-åŠ¨æ€ä»£ç†","link":"#jdk-åŠ¨æ€ä»£ç†","children":[]},{"level":3,"title":"CglibåŠ¨æ€ä»£ç†","slug":"cglibåŠ¨æ€ä»£ç†","link":"#cglibåŠ¨æ€ä»£ç†","children":[]},{"level":3,"title":"JDK åŠ¨æ€ä»£ç†å’Œ Cglib ä»£ç†çš„åŒºåˆ«","slug":"jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-ä»£ç†çš„åŒºåˆ«","link":"#jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-ä»£ç†çš„åŒºåˆ«","children":[]},{"level":3,"title":"Spring çš„ AOP æœ‰å“ªå‡ ç§åˆ›å»ºä»£ç†çš„æ–¹å¼","slug":"spring-çš„-aop-æœ‰å“ªå‡ ç§åˆ›å»ºä»£ç†çš„æ–¹å¼","link":"#spring-çš„-aop-æœ‰å“ªå‡ ç§åˆ›å»ºä»£ç†çš„æ–¹å¼","children":[]}]},{"level":2,"title":"Springäº‹åŠ¡","slug":"springäº‹åŠ¡","link":"#springäº‹åŠ¡","children":[{"level":3,"title":"Springäº‹åŠ¡ä¼ æ’­æœºåˆ¶","slug":"springäº‹åŠ¡ä¼ æ’­æœºåˆ¶","link":"#springäº‹åŠ¡ä¼ æ’­æœºåˆ¶","children":[]},{"level":3,"title":"Spring çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯å¦‚ä½•åšåˆ°å’Œæ•°æ®åº“ä¸ä¸€è‡´çš„ï¼Ÿï¼ˆ5åˆ†ï¼‰","slug":"spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯å¦‚ä½•åšåˆ°å’Œæ•°æ®åº“ä¸ä¸€è‡´çš„-5åˆ†","link":"#spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯å¦‚ä½•åšåˆ°å’Œæ•°æ®åº“ä¸ä¸€è‡´çš„-5åˆ†","children":[]},{"level":3,"title":"springäº‹ç‰©ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ","slug":"springäº‹ç‰©ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ","link":"#springäº‹ç‰©ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ","children":[]}]}],"git":{"createdTime":1713973617000,"updatedTime":1713973617000,"contributors":[{"name":"jossezs","email":"zzss5224@163.com","commits":1}]},"readingTime":{"minutes":13.8,"words":4140},"filePathRelative":"spring/spring-framework.md","localizedDate":"2024å¹´4æœˆ24æ—¥","autoDesc":true}');export{h as comp,f as data};
